/*
 * @copyright 2016-2018 Redoo Networks GmbH
 * @link https://redoo-networks.com/
 * This file is part of a vTigerCRM module, implemented by Redoo Networks GmbH and must not used without permission.
 */
!function(l){"use strict";var r="Workflow2",a={postAction:function(e,t,i,n){return void 0===t&&(t={}),t.module=r,t.action=e,void 0===n&&"string"==typeof i&&(n=i,i=!1),void 0!==i&&1==i&&(t.parent="Settings"),a.post("index.php",t,n)},postSettingsView:function(e,t,i){return a.postView(e,t,!0,i)},postSettingsAction:function(e,t,i){return a.postAction(e,t,!0,i)},postView:function(e,t,i,n){return void 0===t&&(t={}),t.module=r,t.view=e,void 0===n&&"string"==typeof i&&(n=i,i=!1),void 0!==i&&1==i&&(t.parent="Settings"),a.post("index.php",t,n)},post:function(e,t,a){var l=jQuery.Deferred();"object"==typeof e&&(t=e,e="index.php"),void 0===t&&(t={}),void 0===a&&void 0!==t.dataType&&(a=t.dataType);var d={url:e,data:t};return void 0!==a&&(d.dataType=a),d.dataType="text",d.type="POST",jQuery.ajax(d).always(function(t){if(void 0!==a&&"json"==a)try{t=jQuery.parseJSON(t)}catch(e){B.unblockUI(),console.error("FlexAjax Error - Should: JSON Response:"),console.log("Request: ",d),console.log(t);var i=10;jQuery(".RedooAjaxError").each(function(e,t){i+=jQuery(t).height()+30});var n="error_"+Math.floor(1e6*Math.random()),o=t.substr(0,500).replace(/</g,"&lt;").replace(/\\(.?)/g,function(e,t){switch(t){case"\\":return"\\";case"0":return"\0";case"":return"";default:return t}});500<t.length&&(o+=" .....<em>shortened</em>....... "+t.substr(-500).replace(/</g,"&lt;").replace(/\\(.?)/g,function(e,t){switch(t){case"\\":return"\\";case"0":return"\0";case"":return"";default:return t}}));var r='<div class="RedooAjaxError" style="word-wrap:break-word;position:fixed;bottom:'+i+'px;box-sizing:border-box;left:10px;padding:10px;width:25%;background-color:#ffffff;z-index:90000;border:2px solid #C9331E;background-color:#D29D96;" id="'+n+'"><i class="icon-ban-circle" style="margin-top:2px;margin-right:5px;"></i><span style="color:#C9331E;font-weight:bold;">ERROR:</span> '+e+'<br/><span style="color:#C9331E;font-weight:bold;">Response:</span>'+o+"</div>";return jQuery("body").append(r),void jQuery("#"+n).on("click",function(){jQuery(this).fadeOut("fast",function(){jQuery(this).remove()})})}if(void 0!==t.success&&0==t.success&&-1!=t.error.code.indexOf("request"))return confirm("Request Error. Reload of Page is required.")&&window.location.reload(),void B.showNotification(t.error.message,!1);l.resolve(t)}),l.promise()},get:function(e,t,i){console.error("Vtiger do not support GET Requests")},request:function(e){return a.post("index.php",e)}},d={get:function(e,t){return void 0!==o[e]?o[e]:t},set:function(e,t){o[e]=t}},n={init:function(e,t){d.set("__translations_"+e,t)},getTranslator:function(){return function(e){return n.__(e)}},__:function(e){var t=app.getUserLanguage(),i=d.get("__translations_"+t,{});return"function"==typeof i?(n.init(t,i()),n.__(e)):void 0!==i[e]?i[e]:e}},B={layout:null,currentLVRow:null,listViewFields:!1,isVT7:function(){return void 0!==app.helper},showRecordInOverlay:function(e,t){window.open("index.php?module="+e+"&view=Detail&record="+t)},showNotification:function(e,t,i){void 0===t&&(t=!0),void 0===i&&(i={}),B.isVT7()&&(i.message=e,!0===t?app.helper.showSuccessNotification(i):app.helper.showErrorNotification(i))},cacheSet:function(e,t){if(B.isVT7())return app.storage.set(e,t)},cacheGet:function(e,t){if(B.isVT7())return app.storage.get(e,t)},cacheClear:function(e){if(B.isVT7())return app.storage.clear(e)},cacheFlush:function(){if(B.isVT7())return app.storage.flush()},getCurrentDateFormat:function(e){if(e=e.toLowerCase(),!1!==d.get("__CurrentDateFormat_"+e,!1))return d.get("__CurrentDateFormat_"+e,!1);var i,t={};switch(e){case"php":t={yyyy:"%Y",yy:"%y",dd:"%d",mm:"%m"};break;case"moment":t={yyyy:"YYYY",yy:"YY",dd:"DD",mm:"MM"}}return B.isVT7()&&(i=app.getDateFormat()),l.each(t,function(e,t){i=i.replace(e,t)}),d.set("__CurrentDateFormat_"+e,i),i},getCurrentCustomViewId:function(){return!0===B.isVT7()?l('input[name="cvid"]').val():jQuery("#customFilter").val()},selectRecordPopup:function(e,t){var i=jQuery.Deferred(),n=Vtiger_Popup_Js.getInstance();return B.isVT7()?("string"==typeof e&&(e={module:e,view:"Popup",src_module:"Emails",src_field:"testfield"}),void 0!==t&&!0===t&&(e.multi_select=1),app.event.off("FlexUtils.SelectRecord"),app.event.one("FlexUtils.SelectRecord",function(e,t){i.resolveWith(window,[jQuery.parseJSON(t)])}),n.showPopup(e,"FlexUtils.SelectRecord",function(e){})):("string"==typeof e&&(e={module:e,view:"Popup",src_module:"Emails",src_field:"testfield"}),void 0!==t&&!0===t&&(e.multi_select=1),n.show(e,function(e){i.resolveWith(e)})),i.promise()},getCurrentLayout:function(){if(null!==B.layout)return B.layout;var e=jQuery("body").data("skinpath").match(/layouts\/([^/]+)/);return 2<=e.length?(B.layout=e[1],e[1]):B.layout="vlayout"},getQueryParams:function(e){var t=window.document.URL.toString();if(0<t.indexOf("?")){var i=t.split("?")[1].split("&"),n=new Array(i.length),o=new Array(i.length),r=0;for(r=0;r<i.length;r++){var a=i[r].split("=");n[r]=a[0],""!=a[1]?o[r]=decodeURI(a[1]):o[r]="No Value"}for(r=0;r<i.length;r++)if(n[r]==e)return o[r]}return!1},onListChange:function(){if(0==d.get("__onListChangeSignal",!1)){var i=new B.Signal;app.event.on("post.listViewFilter.click",function(e,t){i.dispatch(t)}),d.set("__onListChangeSignal",i)}return d.get("__onListChangeSignal")},onRelatedListChange:function(){if(0==d.get("__onRelatedListChangeSignal",!1)){var i=new B.Signal;app.event.on("post.relatedListLoad.click",function(e,t){i.dispatch(t)}),d.set("__onRelatedListChangeSignal",i)}return d.get("__onRelatedListChangeSignal")},UUIDCounter:1,FieldChangeEventInit:!1,onFieldChange:function(e){void 0===e&&(e="div#page"),void 0===jQuery(e).data("fielduid")&&(jQuery(e).data("fielduid","parentEle"+B.UUIDCounter),B.UUIDCounter++);var r,t=jQuery(e).data("fielduid");if(jQuery(e).addClass("RedooFieldChangeTracker"),0==d.get("__onFieldChangeSignal"+t,!1)){if(r=new B.Signal,B.isVT7())!1===B.FieldChangeEventInit&&"undefined"!=typeof Vtiger_Detail_Js&&(app.event.on(Vtiger_Detail_Js.PostAjaxSaveEvent,function(e,t,i,n){var o=t.closest(".RedooFieldChangeTracker").data("fielduid");(r=d.get("__onFieldChangeSignal"+o)).dispatch({name:t.data("name"),new:i[t.data("name")].value},t,i,n)}),B.FieldChangeEventInit=!0);else if("listview"!==B.getViewMode()&&"undefined"!=typeof Vtiger_Detail_Js){var i=Vtiger_Detail_Js.getInstance(),a=i.getContentHolder();a.on(i.fieldUpdatedEvent,function(e,t){var i=l(e.target),n=i.attr("name"),o=i.closest(".RedooFieldChangeTracker").data("fielduid");(r=d.get("__onFieldChangeSignal"+o)).dispatch({name:n,new:t.new},t,{},a)})}d.set("__onFieldChangeSignal"+t,r)}else r=d.get("__onFieldChangeSignal"+t);return d.get("__onFieldChangeSignal"+t)},getRecordLabels:function(e){var t=jQuery.Deferred(),i=[],n=d.get("LabelCache",{});return jQuery.each(e,function(e,t){void 0===n[t]&&i.push(t)}),0<i.length?a.postAction("RecordLabel",{ids:i,dataType:"json"}).then(function(e){jQuery.each(e.result,function(e,t){n[e]=t}),d.set("LabelCache",n),t.resolveWith({},[n])}):t.resolveWith({},[n]),t.promise()},getFieldList:function(t){var i=jQuery.Deferred();return void 0!==o.FieldLoadQueue[t]?o.FieldLoadQueue[t]:(o.FieldLoadQueue[t]=i,void 0!==o.FieldCache[t]?i.resolve(o.FieldCache[t]):a.post("index.php",{module:r,mode:"GetFieldList",action:"RedooUtils",module_name:t},"json").then(function(e){o.FieldCache[t]=e,i.resolve(e.fields)}),i.promise())},filterFieldListByFieldtype:function(e,n){var o={};return jQuery.each(e,function(e,t){var i=[];jQuery.each(t,function(e,t){t.type==n&&i.push(t)}),0<i.length&&(o[e]=i)}),o},fillFieldSelect:function(n,o,e,t){void 0===t&&(t=""),void 0===e&&(e=moduleName),"string"==typeof o&&(o=[o]),B.getFieldList(e,t).then(function(e){""!=t&&(e=B.filterFieldListByFieldtype(e,t));var i="";jQuery.each(e,function(e,t){i+='<optgroup label="'+e+'">',jQuery.each(t,function(e,t){i+='<option value="'+t.name+'" '+(-1!=jQuery.inArray(t.name,o)?'selected="selected"':"")+">"+t.label+"</option>"}),i+="</optgroup>",jQuery("#"+n).html(i),jQuery("#"+n).hasClass("select2")&&jQuery("#"+n).select2("val",o),jQuery("#"+n).trigger("FieldsLoaded")})})},_getDefaultParentEle:function(){return"div#page"},getMainModule:function(e){return B.isVT7()?B._getMainModuleVT7(e):B._getMainModuleVT6(e)},_getMainModuleVT6:function(e){void 0===e&&(e=B._getDefaultParentEle());var t=B.getViewMode(e);if("detailview"==t||"summaryview"==t)return l("#module",e).val();if("editview"==t||"quickcreate"==t)return l('[name="module"]',e).val();if("listview"==t)return l("#module",e).val();if("relatedview"==t){if(0<l('[name="relatedModuleName"]',e).length)return l('[name="relatedModuleName"]',e).val();if(0<l("#module",e).length)return l("#module",e).val()}var i=B.getQueryParams("module");return!1!==i?i:""},_getMainModuleVT7:function(e){void 0===e&&(e=B._getDefaultParentEle());var t=B.getViewMode(e);if(void 0!==l(e).data("forcerecordmodule"))return l(e).data("forcerecordmodule");if("#overlayPageContent.in"!=e&&0<l("#overlayPageContent.in").length)return B._getMainModuleVT7("#overlayPageContent.in");if("undefined"!=typeof _META&&("detailview"==t||"summaryview"==t||"commentview"==t||"historyview"==t||"editview"==t||"listview"==t)&&0==l(e).hasClass("modal"))return _META.module;if("detailview"==t||"summaryview"==t)return l("#module",e).val();if("editview"==t||"quickcreate"==t)return 0<l("#module",e).length?l("#module",e).val():l('[name="module"]',e).val();if("listview"==t)return l("#module",e).val();if("relatedview"==t){if(0<l('[name="relatedModuleName"]',e).length)return l('[name="relatedModuleName"]',e).val();if(0<l("#module",e).length)return l("#module",e).val()}var i=B.getQueryParams("module");return!1!==i?i:""},getMainRecordId:function(){var e="div#page";void 0===e&&(e=B._getDefaultParentEle());B.getViewMode(e);return l("#recordId",e).val()},getRecordIds:function(e){void 0===e&&(e=B._getDefaultParentEle());var i=[],t=B.getViewMode(e);return"detailview"==t||"summaryview"==t?i.push(l("#recordId",e).val()):"quickcreate"==t||("editview"==t?i.push(l('[name="record"]').val()):"listview"==t?l(".listViewEntries").each(function(e,t){i.push(l(t).data("id"))}):"relatedview"==t&&l(".listViewEntries").each(function(e,t){i.push(l(t).data("id"))})),i},onQuickCreate:function(i){jQuery('.quickCreateModule, .addButton[data-url*="QuickCreate"]').on("click",function e(){if(0==jQuery(".quickCreateContent",".modelContainer").length)window.setTimeout(e,200);else{var t=jQuery(".modelContainer");console.log("onQuickCreate Done"),i(t.find('input[name="module"]').val(),t)}})},getViewMode:function(e){return B.isVT7()?B._getViewModeVT7(e):B._getViewModeVT6(e)},_getViewModeVT6:function(e){void 0===e&&(e=B._getDefaultParentEle());var t=l("#view",e);return o.viewMode=!1,0<t.length&&"List"==t[0].value&&(o.viewMode="listview"),0<l(".detailview-table",e).length?o.viewMode="detailview":0<l(".summaryView",e).length?o.viewMode="summaryview":0<l(".recordEditView",e).length&&(0==l(".quickCreateContent",e).length?o.viewMode="editview":o.viewMode="quickcreate"),0<l(".relatedContents",e).length&&(o.viewMode="relatedview",0<l("td[data-field-type]",e).length?o.popUp=!1:o.popUp=!0),!1===o.viewMode&&0<l("#view",e).length&&"Detail"==l("#view",e).val()&&(o.viewMode="detailview"),o.viewMode},_getViewModeVT7:function(e){return void 0===e&&(e=B._getDefaultParentEle()),o.viewMode=!1,0<l(".detailview-table",e).length?o.viewMode="detailview":0<l(".summaryView",e).length?o.viewMode="summaryview":0<l(".recordEditView",e).length?0==l(".quickCreateContent",e).length?o.viewMode="editview":o.viewMode="quickcreate":0<l(".commentsRelatedContainer",e).length?o.viewMode="commentview":0<l(".HistoryContainer",e).length?o.viewMode="historyview":0<jQuery(".relatedContainer",e).find(".relatedModuleName").length?o.viewMode="relatedview":0<jQuery(".listViewContentHeader",e).length&&"undefined"!=typeof _META&&"List"==_META.view&&(o.viewMode="listview"),!1===o.viewMode&&0<l("#view",e).length&&"Detail"==l("#view",e).val()&&(o.viewMode="detailview"),o.viewMode},getContentMaxHeight:function(){if(0!=B.isVT7())return jQuery("#page").height();switch(B.getCurrentLayout()){case"begbie":return jQuery(".mainContainer").height();default:return jQuery("#leftPanel").height()-50}},getContentMaxWidth:function(){if(0==B.isVT7())return jQuery("#rightPanel").width()},hideModalBox:function(e){!0===B.isVT7()?app.helper.hideModal():app.hideModalWindow()},showModalBox:function(e,t){var i=jQuery.Deferred();!1===B.isVT7()?app.showModalWindow(e,function(e){i.resolveWith(window,e)}):(void 0===t&&(t={close:function(){}}),void 0===t.close&&(t.close=function(){}),d.set("__onModalClose",t.close),0<jQuery(".myModal .modal-dialog").length&&0<jQuery(".modal.in").length?(jQuery(".myModal .modal-dialog").replaceWith(e),i.resolveWith(window,jQuery(".modal.myModal")[0])):app.helper.showModal(e,{cb:function(e){i.resolveWith(window,e)}}).off("hidden.bs.modal").on("hidden.bs.modal",function(){t.close()}));return i.promise()},showContentOverlay:function(e,t){if(B.isVT7())return app.helper.loadPageContentOverlay(e,t);0==l("#overlayPageContent").length&&l("body").append("<div id='overlayPageContent' style=\"margin:0;\" class='fade modal content-area overlayPageContent overlay-container-60' tabindex='-1' role='dialog' aria-hidden='true'>\n        <div class=\"data\">\n        </div>\n        <div class=\"modal-dialog\">\n        </div>\n    </div>");var i=new jQuery.Deferred;t=jQuery.extend({backdrop:!0,show:!0,keyboard:!1},t);var n=l("#overlayPageContent");n.addClass("full-width");var o=!1;return n.hasClass("in")&&(o=!0),n.one("shown.bs.modal",function(){i.resolve(l("#overlayPageContent"))}),n.one("hidden.bs.modal",function(){n.find(".data").html("")}),n.find(".data").html(e),n.modal(t),o&&i.resolve(jQuery("#overlayPageContent")),i.promise()},hideContentOverlay:function(){if(!B.isVT7()){var e=new jQuery.Deferred,t=l("#overlayPageContent");return t.one("hidden.bs.modal",function(){t.find(".data").html(""),e.resolve()}),l("#overlayPageContent").modal("hide"),e.promise()}app.helper.hidePageContentOverlay()},setFieldValue:function(e,t,i){void 0!==i&&null!=i||(i=B._getDefaultParentEle());var n=B.getFieldElement(e,i,!0);switch(n.prop("tagName")){case"INPUT":switch(n.attr("type")){case"text":n.hasClass("dateField")?B.isVT7()?n.datepicker("update",t):""!==t?n.val(t).DatePickerSetDate(t,!0):n.val(t).DatePickerClear():n.val(t);break;case"hidden":if(n.hasClass("sourceField")){var o=Vtiger_Edit_Js.getInstance(),r=n.closest("td");""!=t.id?o.setReferenceFieldValue(r,{id:t.id,name:t.label}):l(".clearReferenceSelection",r).trigger("click")}}break;case"SELECT":n.val(t),!1===B.isVT7()?n.hasClass("chzn-select")&&n.trigger("liszt:updated"):n.hasClass("select2")&&n.trigger("change.select2")}},layoutDependValue:function(e,t){var i=B.getCurrentLayout();return void 0!==e[i]?e[i]:t},getFieldElement:function(e,t,i){if(void 0!==t&&null!=t||(t=B._getDefaultParentEle()),void 0===i&&(i=!1),"object"==typeof e)return e;var n=!1;if("detailview"==B.getViewMode(t))0<l("#"+B.getMainModule(t)+"_detailView_fieldValue_"+e,t).length||0<l("#Events_detailView_fieldValue_"+e,t).length?(n=l("#"+B.getMainModule(t)+"_detailView_fieldValue_"+e),"Calendar"==B.getMainModule(t)&&0==n.length&&(n=l("#Events_detailView_fieldValue_"+e,t))):0<l("#_detailView_fieldValue_"+e,t).length&&(n=l("#_detailView_fieldValue_"+e,t));else if("summaryview"==B.getViewMode(t)){var o;if(0==(o=B.isVT7()?jQuery('[data-name="'+e+'"]',this.parentEle):jQuery('[name="'+e+'"]',this.parentEle)).length)return!1;n=l(o[0]).closest(B.layoutDependValue({vlayout:"td",v7:".row",begbie:"div.mycdivfield"},"td"))}else if("editview"==B.getViewMode(t)||"quickcreate"==B.getViewMode(t)){var r=l('[name="'+e+'"]',t);if(0==r.length)return!1;if(1==i)return r;n=l(r[0]).closest(B.layoutDependValue({vlayout:".fieldValue",v7:".fieldValue",begbie:"div.mycdivfield"},".fieldValue"))}else if("listview"==B.getViewMode(t)){if(!1===B.listViewFields&&(B.listViewFields=B.getListFields(t)),null===B.currentLVRow)return!1;if(void 0===B.listViewFields[e])return!1;n=0<=B.listViewFields[e]?l(l("td.listViewEntryValue",B.currentLVRow)[B.listViewFields[e]]):l(l("td.listViewEntryValue",B.currentLVRow)[-1*Number(B.listViewFields[e]+100)])}else"relatedview"==B.getViewMode(t)&&(!1===B.listViewFields&&(B.listViewFields=B.getListFields(t)),n=0<l("td[data-field-type]",B.currentLVRow).length?l(l("td[data-field-type]",B.currentLVRow)[B.listViewFields[e]]):l(l("td.listViewEntryValue",B.currentLVRow)[B.listViewFields[e]]));return n},refreshContent:function(e,t,i,n){void 0===i&&(n=!1),void 0===i&&(i={}),void 0===t&&(t=!1),i.module=r,i.view=e,!0===t&&(i.parent="Settings");var o=jQuery.Deferred();return B.isVT7()?a.request(i).then(function(e){var t;0<jQuery(".settingsPageDiv").length?(jQuery(".settingsPageDiv").html(e),t=jQuery(".settingsPageDiv")):(jQuery(".ContentReplacement").html(e),t=jQuery(".ContentReplacement")),!0===n&&jQuery(".select2",t).select2(),o.resolve()}):a.request(i).then(function(e){jQuery(jQuery(".contentsDiv")[0]).html(e),!0===n&&jQuery(jQuery(".contentsDiv")[0]).find(".select2").select2(),o.resolve()}),o.promise()},getListFields:function(e){var t;t=B.isVT7()?jQuery(".listview-table .listViewContentHeaderValues",e):jQuery(".listViewEntriesTable .listViewHeaderValues",e);var i={};for(var n in t)if(t.hasOwnProperty(n)&&jQuery.isNumeric(n)){var o=t[n];null==jQuery(o).data("columnname")?i[jQuery(o).data("fieldname")]=n:i[jQuery(o).data("columnname")]=n}return i},loadStyles:function(e,t){"string"==typeof e&&(e=[e]);var i=jQuery.Deferred();return void 0===t&&(t=!1),l.when.apply(l,l.map(e,function(e){return t&&(e+="?_ts="+(new Date).getTime()),l.get(e,function(){l("<link>",{rel:"stylesheet",type:"text/css",href:e}).appendTo("head")})})).then(function(){i.resolve()}),i.promise()},loadScript:function(e,t){var i=jQuery.Deferred();return void 0===d.loadedScript&&(d.loadedScript={}),void 0!==d.loadedScript[e]?(i.resolve(),i):(t=jQuery.extend(t||{},{dataType:"script",cache:!0,url:e}),jQuery.ajax(t))}},o={FieldCache:{},FieldLoadQueue:{},viewMode:!1,popUp:!1};function s(e,t,i,n,o){this._listener=t,this._isOnce=i,this.context=n,this._signal=e,this._priority=o||0}function u(e,t){if("function"!=typeof e)throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))}function t(){this._bindings=[],this._prevParams=null;var e=this;this.dispatch=function(){t.prototype.dispatch.apply(e,arguments)}}"undefined"!=typeof console&&void 0!==console.log&&console.log("Initialize FlexUtils "+r+" V2.3.1"),void 0===window.FlexStore&&(window.FlexStore={}),void 0===window.RedooStore&&(window.RedooStore={}),window.RedooStore[r]=window.FlexStore[r]={Ajax:a,Utils:B,Cache:d,Translate:n},void 0===window.FlexAjax&&(window.FlexAjax=function(e){return void 0!==window.FlexStore[e]?window.FlexStore[e].Ajax:void 0!==window.RedooStore[e]?window.RedooStore[e].Ajax:void console.error("FlexAjax "+e+" Scope not found")}),void 0===window.RedooAjax&&(window.RedooAjax=window.FlexAjax),void 0===window.FlexUtils&&(window.FlexUtils=function(e){return void 0!==window.FlexStore[e]?window.FlexStore[e].Utils:void 0!==window.RedooStore[e]?window.RedooStore[e].Utils:void console.error("FlexUtils "+e+" Scope not found")}),void 0===window.RedooUtils&&(window.RedooUtils=window.FlexUtils),void 0===window.FlexCache&&(window.FlexCache=function(e){return void 0!==window.RedooStore[e]?window.RedooStore[e].Cache:void 0!==window.FlexStore[e]?window.FlexStore[e].Cache:void console.error("FlexCache "+e+" Scope not found")}),void 0===window.RedooCache&&(window.RedooCache=window.FlexCache),void 0===window.FlexTranslate&&(window.FlexTranslate=function(e){if(void 0!==window.FlexStore[e])return window.FlexStore[e].Translate;console.error("FlexTranslate "+e+" Scope not found")}),void 0===window.FlexEvents&&(window.FlexEvents=l({})),t.prototype={VERSION:"1.0.0",memorize:!(s.prototype={active:!0,params:null,execute:function(e){var t;return this.active&&this._listener&&(e=this.params?this.params.concat(e):e,t=this._listener.apply(this.context,e),this._isOnce&&this.detach()),t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}}),_shouldPropagate:!0,active:!0,_registerListener:function(e,t,i,n){var o=this._indexOfListener(e,i);if(-1!==o){if((e=this._bindings[o]).isOnce()!==t)throw Error("You cannot add"+(t?"":"Once")+"() then add"+(t?"Once":"")+"() the same listener without removing the relationship first.")}else e=new s(this,e,t,i,n),this._addBinding(e);return this.memorize&&this._prevParams&&e.execute(this._prevParams),e},_addBinding:function(e){for(var t=this._bindings.length;--t,this._bindings[t]&&e._priority<=this._bindings[t]._priority;);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e,t){for(var i,n=this._bindings.length;n--;)if((i=this._bindings[n])._listener===e&&i.context===t)return n;return-1},has:function(e,t){return-1!==this._indexOfListener(e,t)},add:function(e,t,i){return u(e,"add"),this._registerListener(e,!1,t,i)},addOnce:function(e,t,i){return u(e,"addOnce"),this._registerListener(e,!0,t,i)},remove:function(e,t){u(e,"remove");var i=this._indexOfListener(e,t);return-1!==i&&(this._bindings[i]._destroy(),this._bindings.splice(i,1)),e},removeAll:function(){for(var e=this._bindings.length;e--;)this._bindings[e]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(e){if(this.active){var t,i=Array.prototype.slice.call(arguments),n=this._bindings.length;if(this.memorize&&(this._prevParams=i),n)for(t=this._bindings.slice(),this._shouldPropagate=!0;t[--n]&&this._shouldPropagate&&!1!==t[n].execute(i););}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var e=t;e.Signal=t,B.Signal=e.Signal,function(){function e(Q){function i(e,o){var t,i,n,r,a,l,d,s,u,c=e==window,f=o&&void 0!==o.message?o.message:void 0;if(!(o=Q.extend({},B.blockUI.defaults,o||{})).ignoreIfBlocked||!Q(e).data("blockUI.isBlocked")){if(o.overlayCSS=Q.extend({},B.blockUI.defaults.overlayCSS,o.overlayCSS||{}),t=Q.extend({},B.blockUI.defaults.css,o.css||{}),o.onOverlayClick&&(o.overlayCSS.cursor="pointer"),i=Q.extend({},B.blockUI.defaults.themedCSS,o.themedCSS||{}),f=void 0===f?o.message:f,c&&A&&U(window,{fadeOut:0}),f&&"string"!=typeof f&&(f.parentNode||f.jquery)){var h=f.jquery?f[0]:f,v={};Q(e).data("blockUI.history",v),v.el=h,v.parent=h.parentNode,v.display=h.style.display,v.position=h.style.position,v.parent&&v.parent.removeChild(h)}Q(e).data("blockUI.onUnblock",o.onUnblock);var g,p,w,y,m=o.baseZ;g=O||o.forceIframe?Q('<iframe class="blockUI" style="z-index:'+m+++';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+o.iframeSrc+'"></iframe>'):Q('<div class="blockUI" style="display:none"></div>'),p=o.theme?Q('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+m+++';display:none"></div>'):Q('<div class="blockUI blockOverlay" style="z-index:'+m+++';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>'),o.theme&&c?(y='<div class="blockUI '+o.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(m+10)+';display:none;position:fixed">',o.title&&(y+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(o.title||"&nbsp;")+"</div>"),y+='<div class="ui-widget-content ui-dialog-content"></div>',y+="</div>"):o.theme?(y='<div class="blockUI '+o.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(m+10)+';display:none;position:absolute">',o.title&&(y+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(o.title||"&nbsp;")+"</div>"),y+='<div class="ui-widget-content ui-dialog-content"></div>',y+="</div>"):y=c?'<div class="blockUI '+o.blockMsgClass+' blockPage" style="z-index:'+(m+10)+';display:none;position:fixed"></div>':'<div class="blockUI '+o.blockMsgClass+' blockElement" style="z-index:'+(m+10)+';display:none;position:absolute"></div>',w=Q(y),f&&(o.theme?(w.css(i),w.addClass("ui-widget-content")):w.css(t)),o.theme||p.css(o.overlayCSS),p.css("position",c?"fixed":"absolute"),(O||o.forceIframe)&&g.css("opacity",0);var b=[g,p,w],_=Q(c?"body":e);Q.each(b,function(){this.appendTo(_)}),o.theme&&o.draggable&&Q.fn.draggable&&w.draggable({handle:".ui-dialog-titlebar",cancel:"li"});var k=P&&(!Q.support.boxModel||0<Q("object,embed",c?null:e).length);if(D||k){if(c&&o.allowBodyStretch&&Q.support.boxModel&&Q("html,body").css("height","100%"),(D||!Q.support.boxModel)&&!c)var C=R(e,"borderTopWidth"),x=R(e,"borderLeftWidth"),V=C?"(0 - "+C+")":0,M=x?"(0 - "+x+")":0;Q.each(b,function(e,t){var i=t[0].style;if(i.position="absolute",e<2)c?i.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+o.quirksmodeOffsetHack+') + "px"'):i.setExpression("height",'this.parentNode.offsetHeight + "px"'),c?i.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):i.setExpression("width",'this.parentNode.offsetWidth + "px"'),M&&i.setExpression("left",M),V&&i.setExpression("top",V);else if(o.centerY)c&&i.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"'),i.marginTop=0;else if(!o.centerY&&c){var n="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+(o.css&&o.css.top?parseInt(o.css.top,10):0)+') + "px"';i.setExpression("top",n)}})}if(f&&(o.theme?w.find(".ui-widget-content").append(f):w.append(f),(f.jquery||f.nodeType)&&Q(f).show()),(O||o.forceIframe)&&o.showOverlay&&g.show(),o.fadeIn){var S=o.onBlock?o.onBlock:L,j=o.showOverlay&&!f?S:L,F=f?S:L;o.showOverlay&&p._fadeIn(o.fadeIn,j),f&&w._fadeIn(o.fadeIn,F)}else o.showOverlay&&p.show(),f&&w.show(),o.onBlock&&o.onBlock.bind(w)();if(E(1,e,o),c?(A=w[0],N=Q(o.focusableElements,A),o.focusInput&&setTimeout(T,20)):(n=w[0],r=o.centerX,a=o.centerY,l=n.parentNode,d=n.style,s=(l.offsetWidth-n.offsetWidth)/2-R(l,"borderLeftWidth"),u=(l.offsetHeight-n.offsetHeight)/2-R(l,"borderTopWidth"),r&&(d.left=0<s?s+"px":"0"),a&&(d.top=0<u?u+"px":"0")),o.timeout){var I=setTimeout(function(){c?Q.unblockUI(o):Q(e).unblock(o)},o.timeout);Q(e).data("blockUI.timeout",I)}}}function U(e,t){var i,n,o=e==window,r=Q(e),a=r.data("blockUI.history"),l=r.data("blockUI.timeout");l&&(clearTimeout(l),r.removeData("blockUI.timeout")),t=Q.extend({},B.blockUI.defaults,t||{}),E(0,e,t),null===t.onUnblock&&(t.onUnblock=r.data("blockUI.onUnblock"),r.removeData("blockUI.onUnblock")),n=o?Q("body").children().filter(".blockUI").add("body > .blockUI"):r.find(">.blockUI"),t.cursorReset&&(1<n.length&&(n[1].style.cursor=t.cursorReset),2<n.length&&(n[2].style.cursor=t.cursorReset)),o&&(A=N=null),t.fadeOut?(i=n.length,n.stop().fadeOut(t.fadeOut,function(){0==--i&&d(n,a,t,e)})):d(n,a,t,e)}function d(e,t,i,n){var o=Q(n);if(!o.data("blockUI.isBlocked")){e.each(function(){this.parentNode&&this.parentNode.removeChild(this)}),t&&t.el&&(t.el.style.display=t.display,t.el.style.position=t.position,t.el.style.cursor="default",t.parent&&t.parent.appendChild(t.el),o.removeData("blockUI.history")),o.data("blockUI.static")&&o.css("position","static"),"function"==typeof i.onUnblock&&i.onUnblock(n,i);var r=Q(document.body),a=r.width(),l=r[0].style.width;r.width(a-1).width(a),r[0].style.width=l}}function E(e,t,i){var n=t==window,o=Q(t);if((e||(!n||A)&&(n||o.data("blockUI.isBlocked")))&&(o.data("blockUI.isBlocked",e),n&&i.bindEvents&&(!e||i.showOverlay))){var r="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";e?Q(document).bind(r,i,a):Q(document).unbind(r,a)}}function a(e){if("keydown"===e.type&&e.keyCode&&9==e.keyCode&&A&&e.data.constrainTabKey){var t=N,i=!e.shiftKey&&e.target===t[t.length-1],n=e.shiftKey&&e.target===t[0];if(i||n)return setTimeout(function(){T(n)},10),!1}var o=e.data,r=Q(e.target);return r.hasClass("blockOverlay")&&o.onOverlayClick&&o.onOverlayClick(e),0<r.parents("div."+o.blockMsgClass).length||0===r.parents().children().filter("div.blockUI").length}function T(e){if(N){var t=N[!0===e?N.length-1:0];t&&t.focus()}}function R(e,t){return parseInt(Q.css(e,t),10)||0}Q.fn._fadeIn=Q.fn.fadeIn;var L=Q.noop||function(){},O=/MSIE/.test(navigator.userAgent),D=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent);document.documentMode;var P=Q.isFunction(document.createElement("div").style.setExpression);B.blockUI=function(e){i(window,e)},B.unblockUI=function(e){U(window,e)},Q.growlUI=function(e,t,i,n){var o=Q('<div class="growlUI"></div>');e&&o.append("<h1>"+e+"</h1>"),t&&o.append("<h2>"+t+"</h2>"),void 0===i&&(i=3e3);var r=function(e){e=e||{},Q.blockUI({message:o,fadeIn:void 0!==e.fadeIn?e.fadeIn:700,fadeOut:void 0!==e.fadeOut?e.fadeOut:1e3,timeout:void 0!==e.timeout?e.timeout:i,centerY:!1,showOverlay:!1,onUnblock:n,css:B.blockUI.defaults.growlCSS})};r(),o.css("opacity"),o.mouseover(function(){r({fadeIn:0,timeout:3e4});var e=Q(".blockMsg");e.stop(),e.fadeTo(300,1)}).mouseout(function(){Q(".blockMsg").fadeOut(1e3)})},Q.fn.block=function(e){if(this[0]===window)return Q.blockUI(e),this;var t=Q.extend({},B.blockUI.defaults,e||{});return this.each(function(){var e=Q(this);t.ignoreIfBlocked&&e.data("blockUI.isBlocked")||e.unblock({fadeOut:0})}),this.each(function(){"static"==Q.css(this,"position")&&(this.style.position="relative",Q(this).data("blockUI.static",!0)),this.style.zoom=1,i(this,e)})},Q.fn.unblock=function(e){return this[0]===window?(Q.unblockUI(e),this):this.each(function(){U(this,e)})},B.blockUI.version=2.7,B.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.6,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:2e3,centerX:!0,centerY:!0,allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:400,timeout:0,showOverlay:!0,focusInput:!0,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:!1};var A=null,N=[]}"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],e):e(jQuery)}()}(jQuery);